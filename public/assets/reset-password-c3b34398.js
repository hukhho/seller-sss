import{b as N,n as S,ak as j,r as d,aM as C,j as c,a as e,F as E,B as P}from"./index-57d11ccb.js";import{u as M}from"./index.esm-47ffbe71.js";import{M as R,g as _}from"./index-8073c274.js";import{L as F,S as m}from"./login-layout-0d691b0a.js";import{S as k}from"./index-7c35a557.js";function I(a){try{if(a.split(".").length!==3||typeof a!="string")return null;var t=a.split(".")[1],s="=".repeat((4-t.length%4)%4),r=t.replace("-","+").replace("_","/")+s,u=decodeURIComponent(window.atob(r).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join("")),l=JSON.parse(u);return l}catch{return null}}const B=()=>{const a=N(),t=S(),s=j.parse(t.search.substring(1));let r=null;if(s!=null&&s.token)try{r=I(s.token)}catch{r=null}const[u,l]=d.useState(!1),[o,p]=d.useState(null),[h,f]=d.useState(!1),w=(r==null?void 0:r.email)||(s==null?void 0:s.email)||"",{register:g,handleSubmit:y,formState:n}=M({defaultValues:{password:"",repeat_password:""}}),x=C(),b=i=>{if(l(!1),p(null),i.password!==i.repeat_password){l(!0);return}x.mutate({token:s.token,password:i.password,email:w},{onSuccess:()=>{a("/login")},onError:v=>{p(_(v))}})};return d.useEffect(()=>{n.dirtyFields.password&&n.dirtyFields.repeat_password?f(!0):f(!1)},[n]),c(F,{children:[e(k,{title:"Reset Password"}),e("div",{className:"flex h-full w-full items-center justify-center",children:e("div",{className:"flex min-h-[540px] bg-grey-0 rounded-rounded justify-center",children:c("form",{className:"flex flex-col py-12 w-full px-[120px] items-center",onSubmit:y(b),children:[e(R,{}),r?c(E,{children:[e("span",{className:"inter-2xlarge-semibold mt-4 text-grey-90",children:"Reset your password"}),e("span",{className:"inter-base-regular text-grey-50 mt-2 mb-xlarge",children:"Choose a new password below üëáüèº"}),e(m,{placeholder:"Email",name:"first_name",value:w,readOnly:!0}),e(m,{placeholder:"Password",type:"password",...g("password",{required:!0}),autoComplete:"new-password"}),e(m,{placeholder:"Confirm password",type:"password",...g("repeat_password",{required:!0}),autoComplete:"new-password",className:"mb-0"}),o&&e("span",{className:"text-rose-50 w-full mt-xsmall inter-small-regular",children:"The two passwords are not the same"}),u&&e("span",{className:"text-rose-50 w-full mt-xsmall inter-small-regular",children:"The two passwords are not the same"}),e(P,{variant:"primary",size:"large",type:"submit",className:"w-full mt-base rounded-rounded",loading:n.isSubmitting,disabled:!h,children:"Reset Password"})]}):c("div",{className:"h-full flex flex-col gap-y-2 text-center items-center justify-center",children:[e("span",{className:"inter-large-semibold text-grey-90",children:"You reset link is invalid"}),e("span",{className:"inter-base-regular text-grey-50 mt-2",children:"Please try resetting your password again"})]})]})})})]})};export{B as default};
